# ğŸ“ NITE Exam Checker Bot

×‘×•×˜ ×˜×œ×’×¨× ×œ× ×™×˜×•×¨ ××‘×—× ×™ × ×™×˜×¢ ×•×©×œ×™×—×ª ×”×ª×¨××•×ª ×œ××©×ª××©×™× ×¨×©×•××™×.

## ğŸ“‹ ×ª×™××•×¨

×”×¤×¨×•×™×§×˜ ××•×¨×›×‘ ××©× ×™ ×¨×›×™×‘×™× ×¢×™×§×¨×™×™×:
1. **×‘×•×˜ ××©×ª××©×™×** (`clients.py`) - ×× ×”×œ ×¨×©×™××ª ××©×ª××©×™× ×•×”×¢×“×¤×•×ª ×¢×¨×™×
2. **×‘×•×˜ ××¢×§×‘** (`nite_check.py`) - ×¡×•×¨×§ ×©×™× ×•×™×™× ×‘××¢×¨×›×ª × ×™×˜×¢ ×•×©×•×œ×— ×”×ª×¨××•×ª

## ğŸ—ï¸ ××‘× ×” ×”×¤×¨×•×™×§×˜

```
nite_checker/
â”œâ”€â”€ main.py            # â­ × ×§×•×“×ª ×›× ×™×¡×” - ××¨×™×¥ ×”×›×œ
â”œâ”€â”€ config.py          # ×§×•× ×¤×™×’×•×¨×¦×™×” ××¨×›×–×™×ª
â”œâ”€â”€ db.py              # ×©×›×‘×ª ××¡×“ × ×ª×•× ×™×
â”œâ”€â”€ clients.py         # ×‘×•×˜ Telegram ×œ× ×™×”×•×œ ××©×ª××©×™×
â”œâ”€â”€ nite_check.py      # ×‘×•×˜ ×¡×¨×™×§×ª ×©×™× ×•×™×™×
â”œâ”€â”€ requirements.txt   # ×ª×œ×•×™×•×ª Python
â”œâ”€â”€ .env               # ××©×ª× ×™ ×¡×‘×™×‘×” (×œ× ×‘×’×™×˜!)
â””â”€â”€ exams_data.db      # ××¡×“ × ×ª×•× ×™× SQLite
```

## ğŸ”§ ×”×ª×§× ×”

1. **×©×›×¤×œ ××ª ×”×¤×¨×•×™×§×˜:**
```bash
git clone <repository-url>
cd nite_checker
```

2. **×¦×•×¨ ×¡×‘×™×‘×” ×•×™×¨×˜×•××œ×™×ª:**
```bash
python3 -m venv .venv
source .venv/bin/activate  # Linux/Mac
# ××•
.venv\Scripts\activate  # Windows
```

3. **×”×ª×§×Ÿ ×ª×œ×•×™×•×ª:**
```bash
pip install -r requirements.txt
```

4. **×”×’×“×¨ ××©×ª× ×™ ×¡×‘×™×‘×”:**
×¦×•×¨ ×§×•×‘×¥ `.env` ×¢× ×”×˜×•×§× ×™×:
```
TELEGRAM_TOKEN=your_bot_token_here
```

## ğŸš€ ×”×¨×¦×”

### ğŸ³ ×”×¨×¦×” ×¢× Docker (××•××œ×¥ ×œ×¤×¨×•×“×§×©×Ÿ):

**×”×¨×¦×” ××”×™×¨×”:**
```bash
docker-compose up -d
```

**×‘×“×™×§×ª ×¡×˜×˜×•×¡:**
```bash
docker-compose ps
docker-compose logs -f
```

**×¢×¦×™×¨×ª ×”×‘×•×˜:**
```bash
docker-compose down
```

**×‘× ×™×™×” ××—×“×© ××—×¨×™ ×©×™× ×•×™×™×:**
```bash
docker-compose up -d --build
```

### ğŸ ×”×¨×¦×” ×™×©×™×¨×” ×¢× Python:

**×“×¨×š ××•××œ×¦×ª - ×”×¨×¦×” ××—×ª ×¤×©×•×˜×”:**
```bash
python3 main.py
```
×–×” ××¨×™×¥ ××ª **×©× ×™ ×”×‘×•×˜×™× ×‘××§×‘×™×œ** (client + checker).

**×“×¨×š ×—×œ×•×¤×™×ª - ×”×¨×¦×” × ×¤×¨×“×ª:**
×× ××ª×” ×¨×•×¦×” ×©×œ×™×˜×” ××œ××”, ×”×¨×¥ ×›×œ ×‘×•×˜ ×‘×˜×¨××™× ×œ × ×¤×¨×“:

**×˜×¨××™× ×œ 1 - ×‘×•×˜ ××©×ª××©×™×:**
```bash
python3 clients.py
```

**×˜×¨××™× ×œ 2 - ×‘×•×˜ ×¡×¨×™×§×”:**
```bash
python3 nite_check.py
```

## ğŸ—ºï¸ ×§×•× ×¤×™×’×•×¨×¦×™×” ××¨×›×–×™×ª

### **××™×¤×•×™ ×¢×¨×™× (`config.py`)**

×›×œ ×”××™×“×¢ ×¢×œ ×¢×¨×™× ××¨×•×›×– ×‘×§×•×‘×¥ `config.py`:

```python
CITIES = {
    1: {"name": "×—×™×¤×”", "db_column": "haifa", "display_order": 4},
    2: {"name": "×ª×œ ××‘×™×‘", "db_column": "tel_aviv", "display_order": 1},
    3: {"name": "×™×¨×•×©×œ×™×", "db_column": "jerusalem", "display_order": 3},
    5: {"name": "×‘××¨ ×©×‘×¢", "db_column": "beer_sheva", "display_order": 2}
}
```

**×”××¤×ª×—×•×ª (1, 2, 3, 5) ×”× ×”-city_id ××”-API ×©×œ × ×™×˜×¢!**

### ×¤×•× ×§×¦×™×•×ª ×¢×–×¨:

- `get_city_name(city_id)` - ××§×‘×œ ×©× ×¢×™×¨ ×œ×¤×™ ID
- `get_city_column(city_id)` - ××§×‘×œ ×©× ×¢××•×“×” ×‘-DB ×œ×¤×™ ID
- `get_city_options()` - ××—×–×™×¨ ×¨×©×™××” ×××•×™× ×ª ×©×œ ×¢×¨×™× ×œ×‘×•×˜
- `get_city_columns_map()` - ××™×¤×•×™ ×©××•×ª ×¢×¨×™× ×œ×¢××•×“×•×ª DB


## ğŸ’¾ ××¡×“ × ×ª×•× ×™×

### ×˜×‘×œ××•×ª:

1. **exams** - ××‘×—× ×™× ×¤×¢×™×œ×™× × ×•×›×—×™×™×
2. **exam_log** - ×”×™×¡×˜×•×¨×™×™×ª ×©×™× ×•×™×™× (CREATED/DELETED)
3. **users** - ××©×ª××©×™× ×•×”×¢×“×¤×•×ª ×¢×¨×™×

### ×“×•×’×××•×ª ×©××™×œ×ª×•×ª:

```bash
# ×”×¦×’ ××ª ×›×œ ×”××©×ª××©×™×
sqlite3 exams_data.db "SELECT * FROM users;"

# ×”×¦×’ ××©×ª××©×™× ×©×¨×©×•××™× ×œ×ª×œ ××‘×™×‘
sqlite3 exams_data.db "SELECT user_id FROM users WHERE tel_aviv = 1;"

# ×”×¦×’ ××‘×—× ×™× ×¤×¢×™×œ×™×
sqlite3 exams_data.db "SELECT * FROM exams ORDER BY exam_date;"

# ×”×¦×’ ×”×™×¡×˜×•×¨×™×™×ª ×©×™× ×•×™×™×
sqlite3 exams_data.db "SELECT * FROM exam_log ORDER BY event_timestamp DESC LIMIT 10;"
```

## ğŸ”’ ××‘×˜×—×”

- **×œ×¢×•×œ× ××œ ×ª×¢×œ×” ×§×•×‘×¥ `.env` ×œ×’×™×˜!**
- ×”×§×•×‘×¥ `.gitignore` ××•×’×“×¨ ×œ×—×¡×•× ××•×ª×•
- ×× ×˜×•×§×Ÿ × ×—×©×£, ×‘×˜×œ ××•×ª×• ××™×“ ×“×¨×š BotFather

## ğŸ“Š ×ª×”×œ×™×š ×”×‘×•×˜

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NITE API       â”‚
â”‚  (Every 2-4min) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  nite_check.py  â”‚â”€â”€â”€â”€â–¶â”‚  exams DB    â”‚
â”‚  (Compares)     â”‚     â”‚  (State)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚  New exam?  â”‚
   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
          â”‚ Yes
          â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Get users by    â”‚
   â”‚ city from DB    â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚
            â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ Send Telegram   â”‚
   â”‚ notifications   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ï¿½ ×¤×¨×™×¡×” ×‘×¢× ×Ÿ (Cloud Deployment)

**AWS (ECS/EC2):**
```bash
# Build and push to ECR
docker build -t nite-checker .
docker tag nite-checker:latest <aws-account>.dkr.ecr.region.amazonaws.com/nite-checker:latest
docker push <aws-account>.dkr.ecr.region.amazonaws.com/nite-checker:latest
```

### âš ï¸ ×—×©×•×‘ ×œ×¤×¨×™×¡×” ×‘×¢× ×Ÿ:
- ×•×•×“× ×©×§×•×‘×¥ `.env` ×§×™×™× ×¢× ×”×˜×•×§×Ÿ
- ×”×©×ª××© ×‘-volumes ×œ×©××™×¨×ª ××¡×“ ×”× ×ª×•× ×™×
- ×”×’×“×¨ restart policy ×œ-`always` ××• `unless-stopped`
- ×”×’×“×¨ monitoring ×•-logging

## ï¿½ğŸ› ï¸ ×¤×ª×¨×•×Ÿ ×‘×¢×™×•×ª

### ×”×‘×•×˜ ×œ× ××’×™×‘?
- **Docker**: `docker-compose logs -f` ×œ×‘×“×™×§×ª ×œ×•×’×™×
- **Python**: ×‘×“×•×§ ×©×”×˜×•×§×Ÿ ×‘-`.env` ×ª×§×™×Ÿ
- ×•×“× ×©×”×‘×•×˜ ×¨×¥: `docker ps` ××• `ps aux | grep python`

### ×œ× ××’×™×¢×•×ª ×”×ª×¨××•×ª?
- ×‘×“×•×§ ×©×™×© ××©×ª××©×™× ×¨×©×•××™×: `sqlite3 exams_data.db "SELECT * FROM users;"`
- **Docker**: `docker exec -it nite_checker_bot python3 -c "from db import get_connection; print(list(get_connection().execute('SELECT * FROM users')))"`
- ×‘×“×•×§ ×©-`nite_check.py` ×¨×¥ ×‘×¨×§×¢

### ×©×’×™××ª import?
- ×•×“× ×©×›×œ ×”×§×‘×¦×™× ×‘××•×ª×• ×ª×™×§×™×”
- **Python**: `pip install -r requirements.txt`
- **Docker**: rebuild the image: `docker-compose up -d --build`

### ×‘×¢×™×•×ª ×¢× ××¡×“ ×”× ×ª×•× ×™×?
- ×•×“× ×©×”×ª×™×§×™×” `data/` ×§×™×™××ª
- ×‘×“×•×§ ×”×¨×©××•×ª: `chmod 777 data/`
- **Docker**: volume × ×•×¦×¨ ××•×˜×•××˜×™×ª, ×‘×“×•×§ ×¢× `docker volume ls`

## ğŸ“ ×¨×™×©×™×•×Ÿ

MIT License - ×”×©×ª××© ×‘×—×•×¤×©×™×•×ª!

## ğŸ‘¨â€ğŸ’» ×ª××™×›×”

×œ×‘×¢×™×•×ª ××• ×©××œ×•×ª, ×¤×ª×— issue ×‘×’×™×˜×”××‘.
